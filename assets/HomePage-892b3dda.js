import{d as A,s as k,a as K,c as G,w as S,r as W,b as l,e as X,f as M,g as o,u as e,h as s,F as T,o as O,N as Y,i as ee,j as i,k as c,t as ae,l as te,R as le}from"./index-f1f1bde1.js";import{_ as oe,b as ne,a as ie,c as se,s as Q,d as ce}from"./ActionCard.vue_vue_type_script_setup_true_lang-581ac8b5.js";import{t as re}from"./check-44032eaf.js";import{s as ue,d as de,a as B,g as Z}from"./storage-cb76c2d1.js";import{i as pe,a as ge}from"./import-445e9ac4.js";import{u as ve,N as we,r as fe}from"./table-d36c2dad.js";import{u as d,N as L,a as me,b,c as v,d as U}from"./node-e3ab578c.js";import"./jszip.min-2e2e6be8.js";const he={flex:"","flex-col":"","p-10px":"","gap-10px":"","h-full":""},ke={flex:""},Ce={"h-full":"",flex:"","flex-items-center":""},_e=s("div",{"flex-1":""},null,-1),ye={href:"https://github.com/gkd-kit/inspect",target:"_blank",rel:"noopener noreferrer"},xe=s("svg",{xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 496 512"},[s("path",{d:"M165.9 397.4c0 2-2.3 3.6-5.2 3.6c-3.3.3-5.6-1.3-5.6-3.6c0-2 2.3-3.6 5.2-3.6c3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9c2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9c.3 2 2.9 3.3 5.9 2.6c2.9-.7 4.9-2.6 4.6-4.6c-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2c12.8 2.3 17.3-5.6 17.3-12.1c0-6.2-.3-40.4-.3-61.4c0 0-70 15-84.7-29.8c0 0-11.4-29.1-27.8-36.6c0 0-22.9-15.7 1.6-15.4c0 0 24.9 2 38.6 25.8c21.9 38.6 58.6 27.5 72.9 20.9c2.3-16 8.8-27.1 16-33.7c-55.9-6.2-112.3-14.3-112.3-110.5c0-27.5 7.6-41.3 23.6-58.9c-2.6-6.5-11.1-33.3 2.6-67.9c20.9-6.5 69 27 69 27c20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27c13.7 34.7 5.2 61.4 2.6 67.9c16 17.7 25.8 31.5 25.8 58.9c0 96.5-58.9 104.2-114.8 110.5c9.2 7.9 17 22.9 17 46.4c0 33.7-.3 75.4-.3 83.6c0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252C496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2c1.6 1.6 3.9 2.3 5.2 1c1.3-1 1-3.3-.7-5.2c-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9c1.6 1 3.6.7 4.3-.7c.7-1.3-.3-2.9-2.3-3.9c-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2c2.3 2.3 5.2 2.6 6.5 1c1.3-1.3.7-4.3-1.3-6.2c-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9c1.6 2.3 4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2c-1.4-2.3-4-3.3-5.6-2z",fill:"currentColor"})],-1),ze=s("svg",{xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},[s("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32",d:"M256 112v288"}),s("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32",d:"M400 256H112"})],-1),Ne=s("svg",{xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 1024 1024"},[s("path",{d:"M270.1 741.7c0 23.4 19.1 42.5 42.6 42.5h48.7v120.4c0 30.5 24.5 55.4 54.6 55.4c30.2 0 54.6-24.8 54.6-55.4V784.1h85v120.4c0 30.5 24.5 55.4 54.6 55.4c30.2 0 54.6-24.8 54.6-55.4V784.1h48.7c23.5 0 42.6-19.1 42.6-42.5V346.4h-486v395.3zm357.1-600.1l44.9-65c2.6-3.8 2-8.9-1.5-11.4c-3.5-2.4-8.5-1.2-11.1 2.6l-46.6 67.6c-30.7-12.1-64.9-18.8-100.8-18.8c-35.9 0-70.1 6.7-100.8 18.8l-46.6-67.5c-2.6-3.8-7.6-5.1-11.1-2.6c-3.5 2.4-4.1 7.4-1.5 11.4l44.9 65c-71.4 33.2-121.4 96.1-127.8 169.6h486c-6.6-73.6-56.7-136.5-128-169.7zM409.5 244.1a26.9 26.9 0 1 1 26.9-26.9a26.97 26.97 0 0 1-26.9 26.9zm208.4 0a26.9 26.9 0 1 1 26.9-26.9a26.97 26.97 0 0 1-26.9 26.9zm223.4 100.7c-30.2 0-54.6 24.8-54.6 55.4v216.4c0 30.5 24.5 55.4 54.6 55.4c30.2 0 54.6-24.8 54.6-55.4V400.1c.1-30.6-24.3-55.3-54.6-55.3zm-658.6 0c-30.2 0-54.6 24.8-54.6 55.4v216.4c0 30.5 24.5 55.4 54.6 55.4c30.2 0 54.6-24.8 54.6-55.4V400.1c0-30.6-24.5-55.3-54.6-55.3z",fill:"currentColor"})],-1),Me=A({__name:"HomePage",setup(Se){const C=k([]),p=async()=>{C.value=(await ue.getAllItems()).reverse(),r.value=[]};p();const u=K({query:"",actualQuery:"",updateQuery:()=>{u.actualQuery=u.query.trim(),r.value=[]}}),w=G(()=>{const t=u.actualQuery;return t?C.value.filter(a=>(a.appName||"").includes(t)||(a.appId||"").includes(t)||(a.activityId||"").includes(t)):C.value}),I=d(async()=>{await pe(),await p()}),{activityIdCol:_,appIdCol:q,appNameCol:y,ctimeCol:x,deviceCol:z,appVersionCodeCol:F,appVersionNameCol:J,reseColWidth:$}=ve();S(()=>{const t=w.value.reduce((a,n)=>(a.add(fe(n)),a),new Set);if(t.size<=1){z.filterOptions=void 0;return}z.filterOptions=[...t.values()].map(a=>({value:a,label:a}))}),S(()=>{const t=w.value.reduce((a,n)=>(a.add(n.appName),a),new Set);if(t.size<=1){y.filterOptions=void 0;return}y.filterOptions=[...t.values()].map(a=>({value:a,label:a}))}),S(()=>{const t=w.value.reduce((a,n)=>(a.add(n.activityId),a),new Set);if(t.size<=1){_.filterOptions=void 0;return}_.filterOptions=[...t.values()].map(a=>({value:a,label:a}))});const E=W([{type:"selection"},x,z,y,q,F,J,_,{key:"actions",title:"操作",fixed:"right",width:"255px",render(t){return l(oe,{snapshot:t,onDelete:p},null)}}]),g=K({page:1,pageSize:50,showSizePicker:!0,pageSizes:[50,100],onChange:t=>{g.page=t},onUpdatePageSize:t=>{g.pageSize=t,g.page=1}});X(g,$);const H=t=>{t.columnKey==x.key&&(x.sortOrder=t.order)},N=k(!1),f=k(""),m=d(async()=>{const t=f.value.trim().split(`
`).map(a=>a.trim()).filter(a=>re(a));t.length!=0&&(await ge(t),await p(),f.value="")}),r=k([]),h=()=>Promise.all(r.value.map(t=>B.getItem(t))),j=d(async()=>{await new Promise((t,a)=>{de.warning({title:"删除",content:`是否批量删除 ${r.value.length} 个快照`,negativeText:"取消",positiveText:"确认",onClose:a,onEsc:a,onMaskClick:a,onNegativeClick:a,onPositiveClick:t})}),await Promise.all(r.value.map(t=>B.removeItem(t))),await p()}),P=d(async()=>{await ne(await h())}),V=d(async()=>{await ie(await h())}),R=d(async()=>{const t=await se(await h());Q({content:t.map(a=>Z(a)).join(`
`)+`
`})}),D=d(async()=>{const t=await ce(await h());Q({content:t.map(a=>Z(a)).join(`
`)+`
`})});return(t,a)=>(O(),M(T,null,[l(e(Y),{show:N.value,"onUpdate:show":a[1]||(a[1]=n=>N.value=n),preset:"dialog",title:"导入网络文件",showIcon:!1,positiveText:"确认",negativeText:"取消",style:{width:"800px"},onPositiveClick:e(m).invoke,loading:e(m).loading},{default:o(()=>[l(e(L),{value:f.value,"onUpdate:value":a[0]||(a[0]=n=>{e(m).loading||(f.value=n)}),type:"textarea",placeholder:`仅支持ZIP文件链接
每行一个
空白行自动忽略
非法链接行自动忽略`,autosize:{minRows:8,maxRows:16},inputProps:{style:"white-space: nowrap;"}},null,8,["value"])]),_:1},8,["show","onPositiveClick","loading"]),s("div",he,[s("div",ke,[l(e(v),null,{default:o(()=>[l(e(me),null,{default:o(()=>[l(e(L),{placeholder:"请输入关键字搜索",clearable:"",value:e(u).query,"onUpdate:value":a[2]||(a[2]=n=>e(u).query=n),onKeyup:ee(e(u).updateQuery,["enter"]),onChange:e(u).updateQuery},null,8,["value","onKeyup","onChange"]),l(e(i),{onClick:e(u).updateQuery},{default:o(()=>[c(" 搜索 ")]),_:1},8,["onClick"])]),_:1}),r.value.length?(O(),M(T,{key:0},[l(e(b),null,{trigger:o(()=>[l(e(i),null,{default:o(()=>[c(" 批量下载 ")]),_:1})]),default:o(()=>[l(e(v),{vertical:""},{default:o(()=>[l(e(i),{onClick:e(V).invoke,loading:e(V).loading},{default:o(()=>[c(" 批量下载-快照 ")]),_:1},8,["onClick","loading"]),l(e(i),{onClick:e(P).invoke,loading:e(P).loading},{default:o(()=>[c(" 批量下载-图片 ")]),_:1},8,["onClick","loading"])]),_:1})]),_:1}),l(e(b),null,{trigger:o(()=>[l(e(i),null,{default:o(()=>[c(" 批量分享 ")]),_:1})]),default:o(()=>[l(e(v),{vertical:""},{default:o(()=>[l(e(i),{onClick:e(D).invoke,loading:e(D).loading},{default:o(()=>[c(" 批量生成链接-快照 ")]),_:1},8,["onClick","loading"]),l(e(i),{onClick:e(R).invoke,loading:e(R).loading},{default:o(()=>[c(" 批量生成链接-图片 ")]),_:1},8,["onClick","loading"])]),_:1})]),_:1}),l(e(i),{onClick:e(j).invoke},{default:o(()=>[c(" 批量删除 ")]),_:1},8,["onClick"]),s("div",Ce,ae(`已选中 ${r.value.length} 个快照`),1)],64)):te("",!0)]),_:1}),_e,l(e(v),null,{default:o(()=>[s("a",ye,[l(e(i),null,{icon:o(()=>[l(e(U),null,{default:o(()=>[xe]),_:1})]),_:1})]),l(e(b),null,{trigger:o(()=>[l(e(i),null,{icon:o(()=>[l(e(U),null,{default:o(()=>[ze]),_:1})]),_:1})]),default:o(()=>[l(e(v),{vertical:""},{default:o(()=>[l(e(i),{onClick:e(I).invoke,loading:e(I).loading},{default:o(()=>[c(" 导入本地文件 ")]),_:1},8,["onClick","loading"]),l(e(i),{onClick:a[3]||(a[3]=n=>N.value=!0),loading:e(m).loading},{default:o(()=>[c(" 导入网络文件 ")]),_:1},8,["loading"])]),_:1})]),_:1}),l(e(le),{to:"/device"},{default:o(()=>[l(e(i),null,{icon:o(()=>[l(e(U),null,{default:o(()=>[Ne]),_:1})]),_:1})]),_:1})]),_:1})]),l(e(we),{striped:"",data:w.value,columns:E,scrollX:1800,pagination:e(g),checkedRowKeys:r.value,"onUpdate:checkedRowKeys":a[4]||(a[4]=n=>r.value=n),rowKey:n=>n.id,"onUpdate:sorter":H,size:"small",class:"flex-1",flexHeight:""},null,8,["data","columns","pagination","checkedRowKeys","rowKey"])])],64))}});export{Me as default};
//# sourceMappingURL=HomePage-892b3dda.js.map
